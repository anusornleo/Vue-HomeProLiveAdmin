{"remainingRequest":"/Users/anusornmennakred/Documents/Vue/live-homepro-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/anusornmennakred/Documents/Vue/live-homepro-admin/src/views/LiveNow.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/anusornmennakred/Documents/Vue/live-homepro-admin/src/views/LiveNow.vue","mtime":1597432579734},{"path":"/Users/anusornmennakred/Documents/Vue/live-homepro-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/anusornmennakred/Documents/Vue/live-homepro-admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/anusornmennakred/Documents/Vue/live-homepro-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/anusornmennakred/Documents/Vue/live-homepro-admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBBZ29yYVJUQyBmcm9tICJhZ29yYS1ydGMtc2RrLW5nIjsKaW1wb3J0IGZpcmViYXNlIGZyb20gImZpcmViYXNlIjsKaW1wb3J0IE1lc3NhZ2UgZnJvbSAiQC9jb21wb25lbnRzL01lc3NhZ2UiOwppbXBvcnQgTGl2ZVZpZXdlciBmcm9tICJAL2NvbXBvbmVudHMvTGl2ZVZpZXdlciI7Cgpjb25zdCBkYiA9IGZpcmViYXNlLmZpcmVzdG9yZSgpOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJMaXZlTm93IiwKICBjb21wb25lbnRzOiB7TWVzc2FnZSwgTGl2ZVZpZXdlcn0sCiAgcHJvcHM6IFtdLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjbGllbnQ6IHt9LAogICAgICBhbGxNZXNzYWdlOiBbXSwKICAgICAgc2Nyb2xsUG9zaXRpb246IDAsIC8vIHBvc2l0aW9uIG9mIHNjcm9sbCBjaGF0IHBhbmVsCiAgICAgIHNjcm9sbEhlaWdodDogMCwgLy8KICAgICAgY2hhdEhlaWdodDogMCwgLy8gaGVpZ2h0IG9mIGNoYXQgcGFuZWwKICAgICAgZW5kTGl2ZTogZmFsc2UKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CgogICAgdGhpcy5nZXRDaGF0KCkKICB9LAogIG1ldGhvZHM6IHsKICAgIGFzeW5jIGpvaW5DaGFuZWwoKSB7CiAgICAgIHRoaXMuY2xpZW50ID0gQWdvcmFSVEMuY3JlYXRlQ2xpZW50KHttb2RlOiAnbGl2ZScsIGNvZGVjOiAiaDI2NCJ9KQogICAgfSwKICAgIGdldENoYXQoKSB7CiAgICAgIGRiLmNvbGxlY3Rpb24oJ2NoYXRzJykub3JkZXJCeSgidGltZVN0YW1wIiwpLm9uU25hcHNob3Qoc25hcHNob3QgPT4gewogICAgICAgIHNuYXBzaG90LmRvY0NoYW5nZXMoKS5mb3JFYWNoKGNoYW5nZSA9PiB7CiAgICAgICAgICBpZiAoY2hhbmdlLnR5cGUgPT09ICdhZGRlZCcpIHsKICAgICAgICAgICAgbGV0IGRvYyA9IGNoYW5nZS5kb2M7CiAgICAgICAgICAgIHRoaXMuYWxsTWVzc2FnZS5wdXNoKHsKICAgICAgICAgICAgICBtZXNzYWdlOiBkb2MuZGF0YSgpLm1zZywKICAgICAgICAgICAgICB1c2VybmFtZTogZG9jLmRhdGEoKS51c2VybmFtZQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgc2V0VGltZW91dCh0aGlzLnNjcm9sbFRvRW5kLCAxMDAwKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgc2Nyb2xsVG9FbmQoKSB7CiAgICAgIGxldCBjaGF0ID0gdGhpcy4kZWwucXVlcnlTZWxlY3RvcigiI2NoYXQiKTsKICAgICAgdGhpcy4kZWwucXVlcnlTZWxlY3RvcigiI2NoYXQiKS5hZGRFdmVudExpc3RlbmVyKCJzY3JvbGwiLCB0aGlzLmhhbmRsZVNjcm9sbCk7CiAgICAgIGlmICh0aGlzLmNoYXRIZWlnaHQgKyB0aGlzLnNjcm9sbFBvc2l0aW9uID49IHRoaXMuc2Nyb2xsSGVpZ2h0IC0gNDApIHsKICAgICAgICBjaGF0LnNjcm9sbFRvcCA9IGNoYXQuc2Nyb2xsSGVpZ2h0OwogICAgICB9CiAgICB9LAogICAgaGFuZGxlU2Nyb2xsKGUpIHsKICAgICAgdGhpcy5zY3JvbGxQb3NpdGlvbiA9IGUudGFyZ2V0LnNjcm9sbFRvcAogICAgfSwKICB9LAp9Cg=="},{"version":3,"sources":["LiveNow.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"LiveNow.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <div class=\"flex flex-wrap\">\n      <div class=\"bg-green-100 w-1/2\">\n        <div class=\"flex flex-wrap justify-between\">\n          <h1 class=\"text-3xl mb-6\">Start to Live</h1>\n          <div\n              @click=\"endLive = true\"\n              style=\"height: 45px\"\n              class=\"text-xl items-baseline cursor-pointer bg-red-600 px-5 py-2 rounded-lg hover:bg-red-700 text-white\"\n          >\n            End Live\n            <span class=\"material-icons\" style=\"vertical-align: bottom;margin-bottom: 6px\">live_tv</span>\n          </div>\n        </div>\n        <LiveViewer :endLive=\"endLive\"/>\n      </div>\n      <div class=\"bg-red-100 h-12 w-1/2 pl-5\">\n        <h1 class=\"text-xl mb-6 mt-2\">Comments</h1>\n        <div id=\"chat\" class=\"w-full overflow-auto\" style=\"height: 80vh;\">\n          <Message v-for=\"message in allMessage\" :key=\"message.id\" :message=\"message\"/>\n          <!--          <div class=\"h-24\"></div>-->\n        </div>\n      </div>\n      {{ this.chatHeight + \" \" + this.scrollPosition + \" \" + this.scrollHeight }}\n    </div>\n  </div>\n</template>\n\n<script>\nimport AgoraRTC from \"agora-rtc-sdk-ng\";\nimport firebase from \"firebase\";\nimport Message from \"@/components/Message\";\nimport LiveViewer from \"@/components/LiveViewer\";\n\nconst db = firebase.firestore();\n\nexport default {\n  name: \"LiveNow\",\n  components: {Message, LiveViewer},\n  props: [],\n  data() {\n    return {\n      client: {},\n      allMessage: [],\n      scrollPosition: 0, // position of scroll chat panel\n      scrollHeight: 0, //\n      chatHeight: 0, // height of chat panel\n      endLive: false\n    }\n  },\n  created() {\n\n    this.getChat()\n  },\n  methods: {\n    async joinChanel() {\n      this.client = AgoraRTC.createClient({mode: 'live', codec: \"h264\"})\n    },\n    getChat() {\n      db.collection('chats').orderBy(\"timeStamp\",).onSnapshot(snapshot => {\n        snapshot.docChanges().forEach(change => {\n          if (change.type === 'added') {\n            let doc = change.doc;\n            this.allMessage.push({\n              message: doc.data().msg,\n              username: doc.data().username\n            });\n            setTimeout(this.scrollToEnd, 1000);\n          }\n        });\n      });\n    },\n    scrollToEnd() {\n      let chat = this.$el.querySelector(\"#chat\");\n      this.$el.querySelector(\"#chat\").addEventListener(\"scroll\", this.handleScroll);\n      if (this.chatHeight + this.scrollPosition >= this.scrollHeight - 40) {\n        chat.scrollTop = chat.scrollHeight;\n      }\n    },\n    handleScroll(e) {\n      this.scrollPosition = e.target.scrollTop\n    },\n  },\n}\n</script>\n\n<style scoped>\n\n</style>"]}]}