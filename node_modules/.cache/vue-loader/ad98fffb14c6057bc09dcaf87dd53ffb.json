{"remainingRequest":"/Users/anusornmennakred/Documents/Vue/live-homepro-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/anusornmennakred/Documents/Vue/live-homepro-admin/src/components/LiveViewer.vue?vue&type=style&index=0&id=1d97ec38&scoped=true&lang=css&","dependencies":[{"path":"/Users/anusornmennakred/Documents/Vue/live-homepro-admin/src/components/LiveViewer.vue","mtime":1597657854068},{"path":"/Users/anusornmennakred/Documents/Vue/live-homepro-admin/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/anusornmennakred/Documents/Vue/live-homepro-admin/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/anusornmennakred/Documents/Vue/live-homepro-admin/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/anusornmennakred/Documents/Vue/live-homepro-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/anusornmennakred/Documents/Vue/live-homepro-admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoub3ZlcmxhcFBsYXllciB7CiAgcG9zaXRpb246IGFic29sdXRlOwogIHotaW5kZXg6IDEwOwogIHJpZ2h0OiAwOwogIGJvdHRvbTogMDsKfQoKLm9uUGFnZVBsYXllciB7CiAgcG9zaXRpb246IGFic29sdXRlOwogIHRvcDogMTAwcHg7CiAgbGVmdDogMTAwcHg7Cn0KCi5wbGF5ZXIgewogIGhlaWdodDogNDI2cHg7Cn0KCi5wbGF5ZXIgPj4+IC5hZ29yYV92aWRlb19wbGF5ZXIgewogIHdpZHRoOiA0MjZweDsKICBoZWlnaHQ6IDQyNnB4OwogIG9iamVjdC1maXQ6IGNvbnRhaW4gIWltcG9ydGFudDsKfQoKCiNwcmUtbG9jYWwtcGxheWVyIHsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgei1pbmRleDogMTA7CiAgdG9wOiA3NnB4OwogIGxlZnQ6IDEwNnB4OwogIHRyYW5zaXRpb246IC4zczsKICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgwJSwgMCUpOwp9CgojcHJlLWxvY2FsLXBsYXllci5vdmVybGFwIHsKICBtYXJnaW46IC0xMHB4IDAgMCAtMTBweDsKICBwb3NpdGlvbjogZml4ZWQ7CiAgei1pbmRleDogMTA7CiAgdG9wOiAxMDAlOwogIGxlZnQ6IDEwMCU7CiAgaGVpZ2h0OiAyMDBweDsKICBtaW4td2lkdGg6IDIwMHB4OwogIG1pbi1oZWlnaHQ6IDIwMHB4OwogIHRyYW5zZm9ybTogdHJhbnNsYXRlKC0xMDAlLCAtMTAwJSk7Cn0K"},{"version":3,"sources":["LiveViewer.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsOA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"LiveViewer.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div>\n    <div id=\"pre-local-player\" :style=\"'width:'+setWidth+'px;height:'+setHeight+'px'\"\n         class=\"player\" :class=\"{ overlap: $route.path!=='/live_now' }\">\n    </div>\n    <video id=\"myVideo\" playsinline class=\"video-js vjs-default-skin\" style=\"display: none\">\n      <p class=\"vjs-no-js\">\n        To view this video please enable JavaScript, or consider upgrading to a\n        web browser that\n        <a\n            href=\"https://videojs.com/html5-video-support/\"\n            target=\"_blank\"\n        >supports HTML5 video.</a>\n      </p>\n    </video>\n\n  </div>\n\n</template>\n\n<script>\n/* eslint-disable */\nimport {AGORA_APP_ID} from '@/config/agora.config'\nimport AgoraRTC from \"agora-rtc-sdk-ng\";\nimport \"video.js/dist/video-js.css\";\nimport \"videojs-record/dist/css/videojs.record.css\";\nimport videojs from \"video.js\";\n\nimport \"webrtc-adapter\";\nimport RecordRTC from \"recordrtc\";\n\nimport Record from \"videojs-record/dist/videojs.record.js\";\n\nexport default {\n  name: \"LiveViewer\",\n  data() {\n    return {\n      client: {},\n      localStream: {\n        audioTrack: null,\n        videoTrack: null\n      },\n      localTracks: {\n        videoTrack: null,\n        audioTrack: {\n          getVolumeLevel: function () {\n            return 0;\n          },\n        }\n      },\n      interval: null,\n      player: \"\",\n      isSaveDisabled: true,\n      isStartRecording: false,\n      videoWidth: 0,\n      videoHeight: 0,\n      options: {\n        controls: true,\n        bigPlayButton: false,\n        controlBar: {\n          deviceButton: false,\n          recordToggle: false,\n          pipToggle: false,\n        },\n        width: 100,\n        height: 100,\n        fluid: true,\n        plugins: {\n          record: {\n            pip: false,\n            audio: true,\n            video: true,\n            maxLength: 3000,\n            debug: true,\n          },\n        },\n      },\n    }\n  },\n  async created() {\n    this.client = AgoraRTC.createClient({mode: 'live', codec: \"h264\", role: 'host'})\n\n    await this.client.join(AGORA_APP_ID, 'test1', null);\n\n    [\n      this.localTracks.audioTrack,\n      this.localTracks.videoTrack,\n    ] = await Promise.all([\n      AgoraRTC.createMicrophoneAudioTrack(),\n      AgoraRTC.createCameraVideoTrack(),\n    ]);\n\n    this.setCamera()\n\n    this.localTracks.videoTrack.play(\"pre-local-player\");\n\n    await this.client.publish(Object.values(this.localTracks));\n\n    this.startRecording()\n\n    this.start()\n\n    setTimeout(this.getWidth, 100);\n\n  },\n\n  methods: {\n    setCamera() {\n      this.localTracks.videoTrack.setDevice(this.$store.state.currentOption.camera.deviceId);\n      this.localTracks.audioTrack.setDevice(this.$store.state.currentOption.microphone.deviceId)\n    },\n    async leave() {\n      this.localTracks.audioTrack.stop()\n      this.localTracks.videoTrack.stop()\n      this.localTracks.audioTrack.close()\n      this.localTracks.videoTrack.close()\n      this.localTracks.audioTrack = undefined\n      this.localTracks.videoTrack = undefined\n\n      await this.client.leave();\n    },\n    startRecording() {\n      this.isStartRecording = true;\n      this.player.record().getDevice();\n    },\n    stopRecord() {\n      this.isStartRecording = false;\n      this.player.record().stop();\n      setTimeout(this.submitVideo, 1000);\n      //   this.player.record().saveAs({ video: \"my-video-file-name.webm\" });\n    },\n    submitVideo() {\n      this.player.record().saveAs({video: \"my-video-file-name.mp4\"});\n    },\n    goHome() {\n      this.$router.push({path: '/'})\n    },\n    getWidth() {\n      this.videoWidth = this.localTracks.videoTrack._videoWidth\n      this.videoHeight = this.localTracks.videoTrack._videoHeight\n    },\n    customColorMethod(percentage) {\n      if (percentage < 30) {\n        return \"#cbd5e0\";\n      } else if (percentage < 70) {\n        return \"#38a169\";\n      } else {\n        return \"#f56565\";\n      }\n    },\n    start() {\n      this.$store.state.secondLive = 0\n      this.interval = setInterval(() => {\n        this.continueTime()\n      }, 1000)\n    },\n    continueTime() {\n      this.$store.state.secondLive += 1\n    }\n  },\n  mounted() {\n    this.player = videojs(\"myVideo\", this.options, () => {\n      // print version information at startup\n      let msg =\n          \"Using video.js \" +\n          videojs.VERSION +\n          \" with videojs-record \" +\n          videojs.getPluginVersion(\"record\") +\n          \" and recordrtc \" +\n          RecordRTC.version;\n      videojs.log(msg);\n    });\n    // error handling\n    this.player.on(\"deviceReady\", () => {\n      this.player.record().start();\n      console.log(\"device ready:\");\n    });\n    this.player.on(\"deviceError\", () => {\n      console.log(\"device error:\", this.player.deviceErrorCode);\n    });\n    this.player.on(\"error\", (element, error) => {\n      console.error(error);\n    });\n    // user clicked the record button and started recording\n    this.player.on(\"startRecord\", () => {\n      console.log(\"started recording!\");\n    });\n    // user completed recording and stream is available\n    this.player.on(\"finishRecord\", () => {\n      this.isSaveDisabled = false;\n      console.log(\"finished recording: \", this.player.recordedData);\n    });\n  },\n  computed: {\n    endLive() {\n      return this.$store.state.endLive\n    },\n    setWidth() {\n      if (this.$route.path !== '/live_now') {\n        return this.videoWidth / 4\n      } else {\n        return this.$store.state.sectionLiveWidth\n      }\n    },\n    setHeight() {\n      if (this.$route.path !== '/live_now') {\n        return this.videoHeight / 4\n      } else {\n        return 460\n      }\n    },\n    volumeTest() {\n      return this.localTracks.audioTrack.getVolumeLevel() * 100;\n    },\n  },\n  watch: {\n    endLive(val) {\n      if (val === true) {\n        this.stopRecord()\n        this.leave()\n        this.$store.state.endLive = false\n        this.$store.commit('setIsLive', false)\n        clearInterval(this.interval)\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.overlapPlayer {\n  position: absolute;\n  z-index: 10;\n  right: 0;\n  bottom: 0;\n}\n\n.onPagePlayer {\n  position: absolute;\n  top: 100px;\n  left: 100px;\n}\n\n.player {\n  height: 426px;\n}\n\n.player >>> .agora_video_player {\n  width: 426px;\n  height: 426px;\n  object-fit: contain !important;\n}\n\n\n#pre-local-player {\n  position: absolute;\n  z-index: 10;\n  top: 76px;\n  left: 106px;\n  transition: .3s;\n  transform: translate(0%, 0%);\n}\n\n#pre-local-player.overlap {\n  margin: -10px 0 0 -10px;\n  position: fixed;\n  z-index: 10;\n  top: 100%;\n  left: 100%;\n  height: 200px;\n  min-width: 200px;\n  min-height: 200px;\n  transform: translate(-100%, -100%);\n}\n</style>"]}]}