{"remainingRequest":"/Users/anusornmennakred/Documents/Vue/live-homepro-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/anusornmennakred/Documents/Vue/live-homepro-admin/src/components/LiveViewer.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/anusornmennakred/Documents/Vue/live-homepro-admin/src/components/LiveViewer.vue","mtime":1597435769272},{"path":"/Users/anusornmennakred/Documents/Vue/live-homepro-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/anusornmennakred/Documents/Vue/live-homepro-admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/anusornmennakred/Documents/Vue/live-homepro-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/anusornmennakred/Documents/Vue/live-homepro-admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7QUdPUkFfQVBQX0lEfSBmcm9tICdAL2NvbmZpZy9hZ29yYS5jb25maWcnCmltcG9ydCBBZ29yYVJUQyBmcm9tICJhZ29yYS1ydGMtc2RrLW5nIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBwcm9wczogWydlbmRMaXZlJ10sCiAgbmFtZTogIkxpdmVWaWV3ZXIiLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjbGllbnQ6IHt9LAogICAgICBsb2NhbFN0cmVhbTogewogICAgICAgIGF1ZGlvVHJhY2s6IG51bGwsCiAgICAgICAgdmlkZW9UcmFjazogbnVsbAogICAgICB9LAogICAgICBsb2NhbFRyYWNrczogewogICAgICAgIHZpZGVvVHJhY2s6IG51bGwsCiAgICAgICAgYXVkaW9UcmFjazogbnVsbAogICAgICB9LAogICAgfQogIH0sCiAgYXN5bmMgY3JlYXRlZCgpIHsKICAgIHRoaXMuY2xpZW50ID0gQWdvcmFSVEMuY3JlYXRlQ2xpZW50KHttb2RlOiAnbGl2ZScsIGNvZGVjOiAiaDI2NCIsIHJvbGU6ICdob3N0J30pCgogICAgYXdhaXQgdGhpcy5jbGllbnQuam9pbihBR09SQV9BUFBfSUQsICd0ZXN0MScsIG51bGwpOwoKICAgIFsKICAgICAgdGhpcy5sb2NhbFRyYWNrcy5hdWRpb1RyYWNrLAogICAgICB0aGlzLmxvY2FsVHJhY2tzLnZpZGVvVHJhY2ssCiAgICBdID0gYXdhaXQgUHJvbWlzZS5hbGwoWwogICAgICBBZ29yYVJUQy5jcmVhdGVNaWNyb3Bob25lQXVkaW9UcmFjaygpLAogICAgICBBZ29yYVJUQy5jcmVhdGVDYW1lcmFWaWRlb1RyYWNrKCksCiAgICBdKTsKCiAgICB0aGlzLnNldENhbWVyYSgpCgogICAgdGhpcy5sb2NhbFRyYWNrcy52aWRlb1RyYWNrLnBsYXkoInByZS1sb2NhbC1wbGF5ZXIiKTsKCiAgICBhd2FpdCB0aGlzLmNsaWVudC5wdWJsaXNoKE9iamVjdC52YWx1ZXModGhpcy5sb2NhbFRyYWNrcykpOwoKICB9LAoKICBtZXRob2RzOiB7CiAgICBzZXRDYW1lcmEoKSB7CiAgICAgIHRoaXMubG9jYWxUcmFja3MudmlkZW9UcmFjay5zZXREZXZpY2UodGhpcy4kc3RvcmUuc3RhdGUuY3VycmVudE9wdGlvbi5jYW1lcmEuZGV2aWNlSWQpOwogICAgICB0aGlzLmxvY2FsVHJhY2tzLmF1ZGlvVHJhY2suc2V0RGV2aWNlKHRoaXMuJHN0b3JlLnN0YXRlLmN1cnJlbnRPcHRpb24ubWljcm9waG9uZS5kZXZpY2VJZCkKICAgIH0sCiAgICBhc3luYyBsZWF2ZSgpIHsKICAgICAgdGhpcy5sb2NhbFRyYWNrcy5hdWRpb1RyYWNrLnN0b3AoKQogICAgICB0aGlzLmxvY2FsVHJhY2tzLnZpZGVvVHJhY2suc3RvcCgpCiAgICAgIHRoaXMubG9jYWxUcmFja3MuYXVkaW9UcmFjay5jbG9zZSgpCiAgICAgIHRoaXMubG9jYWxUcmFja3MudmlkZW9UcmFjay5jbG9zZSgpCiAgICAgIHRoaXMubG9jYWxUcmFja3MuYXVkaW9UcmFjayA9IHVuZGVmaW5lZAogICAgICB0aGlzLmxvY2FsVHJhY2tzLnZpZGVvVHJhY2sgPSB1bmRlZmluZWQKCiAgICAgIGF3YWl0IHRoaXMuY2xpZW50LmxlYXZlKCk7CiAgICB9CiAgfSwKICB3YXRjaDogewogICAgZW5kTGl2ZSh2YWwpIHsKICAgICAgaWYgKHZhbCA9PT0gdHJ1ZSkgewogICAgICAgIHRoaXMubGVhdmUoKQogICAgICB9CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["LiveViewer.vue"],"names":[],"mappings":";;;;;;;AAOA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"LiveViewer.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div>\n    <div id=\"pre-local-player\" class=\"player w-full\"></div>\n  </div>\n</template>\n\n<script>\nimport {AGORA_APP_ID} from '@/config/agora.config'\nimport AgoraRTC from \"agora-rtc-sdk-ng\";\n\nexport default {\n  props: ['endLive'],\n  name: \"LiveViewer\",\n  data() {\n    return {\n      client: {},\n      localStream: {\n        audioTrack: null,\n        videoTrack: null\n      },\n      localTracks: {\n        videoTrack: null,\n        audioTrack: null\n      },\n    }\n  },\n  async created() {\n    this.client = AgoraRTC.createClient({mode: 'live', codec: \"h264\", role: 'host'})\n\n    await this.client.join(AGORA_APP_ID, 'test1', null);\n\n    [\n      this.localTracks.audioTrack,\n      this.localTracks.videoTrack,\n    ] = await Promise.all([\n      AgoraRTC.createMicrophoneAudioTrack(),\n      AgoraRTC.createCameraVideoTrack(),\n    ]);\n\n    this.setCamera()\n\n    this.localTracks.videoTrack.play(\"pre-local-player\");\n\n    await this.client.publish(Object.values(this.localTracks));\n\n  },\n\n  methods: {\n    setCamera() {\n      this.localTracks.videoTrack.setDevice(this.$store.state.currentOption.camera.deviceId);\n      this.localTracks.audioTrack.setDevice(this.$store.state.currentOption.microphone.deviceId)\n    },\n    async leave() {\n      this.localTracks.audioTrack.stop()\n      this.localTracks.videoTrack.stop()\n      this.localTracks.audioTrack.close()\n      this.localTracks.videoTrack.close()\n      this.localTracks.audioTrack = undefined\n      this.localTracks.videoTrack = undefined\n\n      await this.client.leave();\n    }\n  },\n  watch: {\n    endLive(val) {\n      if (val === true) {\n        this.leave()\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.player {\n  height: 426px;\n}\n\n.player >>> .agora_video_player {\n  width: 426px;\n  height: 426px;\n  object-fit: contain !important;\n}\n</style>"]}]}